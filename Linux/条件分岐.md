# 【Shell Script】条件分岐

シェルスクリプトの  
条件によって処理を分岐するためのコマンド（if 文、case 文、test コマンド）についてまとめました。

# if 文

「if」は、<span style="background: linear-gradient(transparent 60%, #ffff00 60%）;">条件に合致した場合(真）</span>に処理を実行する。

<div style="background: #f5f5f5;  border-radius: 5px; padding: 10px; margin: 10px;">
<p style="margin: 0;">
if [ 条件式 ]<br>
then<br>
  条件に合致した場合の処理<br>
fi
</p>
</div>

- [ 条件式 ]のように、[]と条件式の間に必ず半角スペースをいれる。
- 条件式に合致しない（偽）の場合は、処理をスキップする。

##### 条件式にいれる比較演算子や条件

- **数値の比較**

| 演算子            | 内容（数値１と数値２が） |
| :---------------- | :----------------------- |
| 数値 1 -eq 数値 2 | 等しい(=)                |
| 数値 1 -ne 数値 2 | 等しくない(!=)           |
| 数値 1 -gt 数値 2 | 数値 2 より大きい(>)     |
| 数値 1 -ge 数値 2 | 数値 2 以上(=>)          |
| 数値 1 -lt 数値 2 | 数値 2 より小さい(<)     |
| 数値 1 -le 数値 2 | 数値 2 以下(=<)          |

- **文字列の比較**

| 演算子               | 内容（文字列 1 と文字列 2） |
| :------------------- | :-------------------------- |
| 文字列 1 = 文字列 2  | 等しい                      |
| 文字列 1 != 文字列 2 | 等しくない                  |
| -n 文字列            | 文字列の長さが 1 以上       |
| -z 文字列            | 文字列の長さが 0 か         |

- **その他の条件式**

| 演算子                        | 内容（対象が）                   |
| :---------------------------- | :------------------------------- |
| -e ファイル名/ディレクトリ名  | 存在する                         |
| -d ファイル名/ディレクトリ名  | ディレクトリである               |
| -f ファイル名/ディレクトリ名  | ファイルである                   |
| -s ファイル名/ディレクトリ名  | サイズが 0 より大きい            |
| ファイル名 1 -ot ファイル名 2 | ファイル 1 がファイル 2 より古い |

##### 複数条件

「elif」は、<span style="background: linear-gradient(transparent 60%, #ffff00 60%);">if の条件は偽、elif の条件が真</span>の場合に処理を実行する。複数回指定できる。  
「else」は、<span style="background: linear-gradient(transparent 60%, #ffff00 60%);">すべての条件が偽</span>の場合の処理。1 回のみ指定できる。

```bash
#!/bin/bash

if [ -f $1 ]; then
  echo "$1はファイルです。"
elif [ -d $1 ]; then
  echo "$1はディレクトリです。"
else
  echo "どちらでもありません。"
fi
```

スクリプトを実行すると

```bash
$ スクリプトファイル名 引数$1
[引数で指定したディレクトリ名]はディレクトリです。
```

指定した引数が、ファイル・ディレクトリ・どちらでもないかを判定してくれる。

- **論理式を利用した条件式**

| 記述方法      | 判定内容                    |
| :------------ | :-------------------------- |
| -a または&&   | AND。すべての条件に合致する |
| -o または\|\| | OR。いずれか条件に合致する  |
| !             | NOT。真偽を反転して返す     |

# test コマンド

test コマンドとは、条件を判定することに特化したコマンド。  
<span style="background: linear-gradient(transparent 60%, #ffff00 60%);">終了ステータスで真偽値を返す。 </span>

```bash
$ test 1 -eq 1 ; echo $?
0
$ [ 1 -eq 2 ]; echo $?
1
```

`test [オプション] 条件式`  
`[ 条件式 ]`

[ 条件式 ]のように、[]と条件式の間に必ず半角スペースをいれる。

- 終了ステータスとは、  
  実行したコマンドやプログラムが終了したときに、返される短い値のこと。  
  <span style="background: linear-gradient(transparent 40%, #F9C1CF 100%);">「$?」で取得でき、真の場合は「0」、偽の場合は「1」と表示する。</span>

- if 文の条件式には、test コマンドを使うことが多く、  
  条件式に指定されたコマンドの終了ステータスを判定し分岐を行っている。

# case 文

case 文は、<span style="background: linear-gradient(transparent 60%, #ffff00 60%);">複数の条件によって処理を分岐</span>するときに使う。

- 多方向分岐に優れた文法で、if 文よりシンプルに記述できる。
- 条件に一致し処理が実行されると、その後の条件はスキップされる。(;;で終了指示)
- パターンの文字列は完全一致のときにのみ合致する。

<div style="background: #f5f5f5;  border-radius: 5px; padding: 10px; margin: 10px;">
<p style="margin: 0;">
case 値 in<br>
パターン1）処理1<br>
;;<br>
パターン2）処理2<br>
;;<br>
パターン3）処理3<br>
;;<br>
esac
</p>
</div>

```bash
#!/bin/bash

read input   #ユーザーからの入力値をinput変数に格納

case $input in #入力値が
  yes ）
   echo "はい"
   ;;
  no ）
   echo "いいえ"
   ;;
  * ）      #上記条件以外のすべて
   echo "yes,noのどちらかを選択してください"
   ;;
esac
```

```bash
$ ./ファイル名
yes        #ユーザーからの入力
はい
```

---

### 参考にしたサイト

- [https://qiita.com/go1101/items/37c5a58185e4dbea4d08]
- [https://shellscript.sunone.me/if_and_test.html#test-%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89]
- [https://qiita.com/kazuooooo/items/163d07f694016ebd6048]
- SL スタジオ
