# 【Shell】シェル変数と環境変数の定義と違い

# Linux OS の構成

Linux の OS は、「カーネル」「シェル」「その他のプログラム」から構成される。

- **カーネル**とは、  
  <span style="background: linear-gradient(transparent 60%, #ffff00 60%);">OS の中枢部分</span>であり、コンピューターの基本的な機能を制御する。  
  ハードウェアとソフトフェアの橋渡しをする。  
  プロセス管理、メモリ管理、デバイス制御、ファイルシステムの管理など。

- **シェル**とは、  
  <span style="background: linear-gradient(transparent 60%, #ffff00 60%);">ユーザーとカーネルの間</span>を橋渡しする。  
  ユーザーからコマンドを受け取り、命令を解釈しカーネルへ伝え、結果をユーザーに表示する。

- **シェルスクリプト**とは、  
  <span style="background: linear-gradient(transparent 60%, #ffff00 60%);">シェルが理解できる命令をまとめたプログラムのファイル</span>のこと。  
  複雑な処理や繰り返し処理を効率的に実行できる。
  拡張子は.sh

<div style="height: 12px;"><span style="margin-left: 8px; padding: 6px 10px; background:#FBB161 ; color: #ffffff; font-weight: bold; border-radius: 5px;">☀︎代表的なシェル☀︎</span></div>
<div style="border: 2px solid#FBB161 ; padding: 25px 12px 10px; font-size: 1em; border-radius: 5px;">
【sh】古くからあり標準記述言語としてよく使われる。Bシェルとも呼ぶ。<br>
【Bash】shの上位互換のシェル。Linuxで起動したらbashが使われている。<br>
【zsh】BashにCシェル系も取り込み、さらに進化させた高機能シェル。<br>
</div>

# シェル変数と環境変数

#### シェル変数とは

現在実行中のシェルでしか使用できない変数。  
新しい bash を起動したら、その変数は受け継がれない。  
ローカル変数ともいわれる。

- <span style="background: linear-gradient(transparent 40%, #F9C1CF 100%);">シェル変数を定義(宣言)するには、「変数名=値」 </span> と書く。  
  （=の前後にスペースは入れない。）

- <span style="background: linear-gradient(transparent 40%, #F9C1CF 100%);">定義したシェル変数を利用(参照)するには、「$変数名」</span>と書く。

```bash
#!/bin/bash

num=100      #宣言
echo $num    #参照
```

- **シェルスクリプトの実行方法**  
  コンソール画面で入力する。3 通りある。  
  １．ファイルが保存されているディレクトリ上でファイル名を直接実行する。  
   $ ./ファイル名  
  ２．bash コマンドにより実行する。  
   $ bash ファイル名  
  ３．sources コマンドにより実行する。  
   $ source ファイル名

#### 環境変数とは

他のシェルに移動したり、シェルスクリプトを使っても利用することができる変数。  
子プロセスにも引き継がれる。  
グローバル変数ともいわれる。

- <span style="background: linear-gradient(transparent 40%, #F9C1CF 100%);">環境変数を定義(宣言)するには、「export 変数名=値」 </span> と書く。  
  （=の前後にスペースは入れない。）

- <span style="background: linear-gradient(transparent 40%, #F9C1CF 100%);">定義した環境変数を利用(参照)するには、「$変数名」</span>と書く。

```bash
#!/bin/bash

export PATH="/usr/local/bin:$PATH"    #宣言
echo $PATH    #参照
```

######シェル関数を環境関数に変換する

すでに定義されているシェル関数を環境関数に追加するには、<span style="background: linear-gradient(transparent 40%, #F9C1CF 100%);">export コマンド</span>を使う。

```bash
#!/bin/bash

FOO="bar"    #シェル変数を定義
export FOO   #環境変数として追加

```

---

##### 変数の一覧を表示

設定されている変数の一覧を表示するには、<span style="background: linear-gradient(transparent 60%, #ffff00 60%);">set コマンド</span>を使う。  
コンソールで「set」と入力すると、シェル変数と環境変数の両方が表示される。

##### 変数の削除

変数の削除には、<span style="background: linear-gradient(transparent 60%, #ffff00 60%);">unset コマンド</span>を使う。  
コンソールで「unset 変数名」と入力する。

#### 違いと共通点

###### 違い

- シェル変数よりも環境変数の方が有効範囲が広い。

###### 共通点

- ログアウトすると削除される。  
  変数を次回も有効にしたいときは、~/.bashrc または ~/.bash_profile ファイルに追記しておく。

# read コマンドとは

read コマンドとは、標準入力の値を指定した変数に代入するコマンド。

- 変数を代入する方法は２通りある。

１．キーボードから対話的に入力された内容を代入する。

```bash
$ read var
aaa    #コンソールからキーボード入力
$ echo $var
aaa
```

- read コマンドを実行すると、  
  ユーザーからの入力を待ち、入力された値が var 変数に格納される。
- 変数名を省略したときは、REPLY 変数に格納される。
- 引数に複数の変数を指定したときは、入力した行は単語毎に区切られ代入される。

- read コマンドのオプション  
  -p プロンプトを表示  
   $read -p " 名前を入力："  
  -s 入力を画面に表示しない。パスワード入力など。  
  -n 文字数を制限する。

２．ファイルの内の内容を while 文などを使用して１行ずつ変数に代入する。
`while read 変数名`

---

### 参考にしたサイト

- [https://www.reqtc.com/blog/shell-kernel-bash.html]
- [https://udemy.benesse.co.jp/development/what-is-kernel.html]
- [https://l-study.arcjp.com/lpic/linux-essentials/linux-essentials-online-text/le-12-1/] -[https://uxmilk.jp/52370]
- [https://linuxcommand.net/read/]
